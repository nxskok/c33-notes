## Summarizing data in R
- Have seen `summary` (5-number summary of each column). But what
if we want:
  - a summary or two of just one column
  - a count of observations in each category of a categorical variable
  - summaries by group
  - a different summary of all columns (eg. SD)
- To do this, meet pipe operator `%>%`. This takes input data frame,
does something to it, and outputs result. (Learn: `Ctrl-Shift-M`.) 
- Output from a pipe can be used as input to something else, so can
have a sequence of pipes.
- Summaries include: mean, median, min, max, sd, IQR, quantile (for
obtaining quartiles or any percentile), n (for counting observations).
- Use our Australian athletes data again.

## Packages for this section

```{r, eval=F}
library(tidyverse)
```

```{r, echo=F, message=F}
my_url="http://www.utsc.utoronto.ca/~butler/c32/ais.txt"
athletes=read_tsv(my_url)
```


## Summarizing one column
- Mean height: 

```{r}
athletes %>% summarize(m=mean(Ht))
```

or to get mean and SD of BMI:

```{r}
athletes %>% summarize(m=mean(BMI),s=sd(BMI))
```

## Quartiles

- `quantile` calculates percentiles ("fractiles"), so we want the 25th and 75th
percentiles:


```{r}
athletes %>% summarize( Q1=quantile(Wt, 0.25),
                        Q3=quantile(Wt, 0.75))
```

## Creating new columns

- These weights are in kilograms. Maybe we want to summarize the
weights in pounds.
- Convert kg to lb by multiplying by 2.2.
- Create new column and summarize that: 

```{r}
athletes %>% mutate(wt_lb=Wt*2.2) %>%
  summarize(Q1_lb=quantile(wt_lb, 0.25),
            Q3_lb=quantile(wt_lb, 0.75))
```

## Counting how many
for example, number of athletes in
each sport: 

```{r}
athletes %>% count(Sport)
```

## Counting how many, variation 2:

Another way (which will make sense
in a moment):

```{r}
athletes %>% group_by(Sport) %>%
  summarize(count=n())
```

## Summaries by group
- Might want separate summaries for each “group”, eg. mean and SD
of height for males and females. Strategy is `group_by` (to define the
groups) and then `summarize`: 

```{r}
athletes %>% group_by(Sex) %>% 
  summarize(m=mean(Ht), s=sd(Ht))
```

- This explains second variation on counting within group: “within each
sport, how many athletes were there?”

## Summarizing several columns

- Standard deviation of each (numeric) column: 

```{r}
athletes %>% summarize_if(is.numeric, sd)
```

- Median and IQR of all columns whose name starts with H: 
```{r}
athletes %>% summarize_at(vars(starts_with("H")),
                          list(med=median, iqr=IQR))
```

